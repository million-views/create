---
title: "Development Guide"
type: "guide"
audience: "advanced"
estimated_time: "30 minutes setup, reference thereafter"
prerequisites:
  - "Modern Node.js development experience (latest LTS)"
  - "Git and npm familiarity"
  - "Command line proficiency"
related_docs:
  - "../../CONTRIBUTING.md"
  - "../guides/troubleshooting.md"
  - "../reference/cli-reference.md"
last_updated: "2025-11-12"
---

# Development Guide

Complete guide for developing and testing @m5nv/create-scaffold locally.

## Quick Start

```bash
#Clone the repository
git clone https://github.com/million-views/create.git
cd create

#Install development dependencies
npm install

#Run tests to verify setup
npm test

#Test CLI locally (package is not published yet)
node bin/create-scaffold/index.mjs --help
node bin/create-scaffold/index.mjs --experimental-placeholder-prompts
npx . new test-project react-vite

#Optional: expose the create-scaffold binary globally
npm link
create-scaffold new scratch-app react-vite
npm unlink -g @m5nv/create-scaffold
```

> Note: Template repositories now include a `.template-undo.json` file generated by the make-template tool. Keep this file checked in‚Äîit supports template authors during local iterations‚Äîbut `@m5nv/create-scaffold` automatically ignores it during copying, dry runs, and setup runtime operations.

## Codebase Architecture

### Module Organization

The codebase follows a modular architecture with clear separation of concerns:

```console
create/
‚îú‚îÄ‚îÄ bin/                           # CLI command entry points
‚îÇ   ‚îú‚îÄ‚îÄ create-scaffold/          # Create-scaffold command implementation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.mjs             # Main create-scaffold entry point
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/             # Individual create-scaffold subcommands
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ new/              # Project creation command
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ list/             # Template listing command
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validate/         # Template validation command
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ modules/              # Shared create-scaffold modules
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ cache-manager.mjs # Template repository caching
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ config-loader.mjs # Configuration file loading
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dry-run-engine.mjs # Preview mode operations
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ guided-setup-workflow.mjs # Interactive setup flow
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ options-processor.mjs # CLI argument processing
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ placeholder-resolver.mjs # Template variable substitution
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ registry/         # Template registry management
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ security.mjs      # Input validation and security
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ setup-runtime.mjs # Template setup script execution
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ template-resolver.mjs # Template discovery and loading
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ template-validation.mjs # Template manifest validation
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ utils/            # Shared utility functions
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ validators/       # Input validation utilities
‚îÇ   ‚îî‚îÄ‚îÄ make-template/            # Make-template command implementation
‚îÇ       ‚îú‚îÄ‚îÄ index.mjs             # Main make-template entry point
‚îÇ       ‚îî‚îÄ‚îÄ commands/             # Make-template subcommands
‚îú‚îÄ‚îÄ docs/                         # User and developer documentation
‚îú‚îÄ‚îÄ tests/                        # Comprehensive test suites
‚îú‚îÄ‚îÄ scripts/                      # Development and testing utilities
‚îî‚îÄ‚îÄ .kiro/specs/                  # Feature specifications and design docs
```

### Core Design Principles

**Zero Dependencies**: The project uses only Node.js built-in modules to minimize attack surface and ensure reliability.

**Security First**: All user inputs are validated and sanitized. No external code execution without explicit user consent.

**ES Modules Only**: Modern JavaScript patterns throughout, with `type: "module"` in package.json.

**Test-Driven Development**: Comprehensive test coverage across multiple specialized test suites.

### Key Modules

#### CLI Entry Points

**Create-Scaffold (`bin/create-scaffold/index.mjs`)**:
- Main entry point for the create-scaffold command
- Orchestrates argument parsing, validation, and command dispatch
- Coordinates between subcommands and shared modules
- Manages error handling and user feedback

**Make-Template (`bin/make-template/index.mjs`)**:
- Main entry point for the make-template command
- Handles template authoring and conversion workflows
- Manages template validation and project-to-template operations

#### Core Modules

**Options Processor (`bin/create-scaffold/modules/options-processor.mjs`)**:
- Processes and validates CLI arguments using native `util.parseArgs`
- Supports all CLI options: `--help`, `--log-file`, `--dry-run`, `--no-cache`, `--experimental-placeholder-prompts`, `--yes`, `--cache-ttl`
- Provides comprehensive help text and usage information

**Guided Setup Workflow (`bin/create-scaffold/modules/guided-setup-workflow.mjs`)**:
- Drives the interactive prompt workflow for template selection and input capture
- Coordinates repository caching, catalog formatting, and placeholder prompts
- Returns normalized arguments that continue through the CLI pipeline

**Security Module (`bin/create-scaffold/modules/security.mjs`)**:
- Validates all user inputs for security compliance
- Prevents path traversal attacks (`../` sequences)
- Blocks command injection in repository URLs and branch names
- Sanitizes error messages to prevent information disclosure

**Cache Manager (`bin/create-scaffold/modules/cache-manager.mjs`)**:
- Manages local template repository caching in `~/.m5nv/cache`
- Implements TTL-based cache expiration (24-hour default)
- Provides cache bypass with `--no-cache` flag
- Handles cache corruption recovery automatically

**Template Resolver (`bin/create-scaffold/modules/template-resolver.mjs`)**:
- Handles template discovery and loading from various sources
- Supports local paths, git repositories, and registry lookups
- Manages template metadata parsing and validation
- Coordinates with cache manager for performance optimization

**Setup Runtime (`bin/create-scaffold/modules/setup-runtime.mjs`)**:
- Executes template setup scripts in isolated environments
- Manages environment variable injection and script sandboxing
- Handles setup script failures gracefully with user feedback
- Ensures cleanup of temporary resources and artifacts

## Configuration Defaults

The CLI can bootstrap defaults from configuration files so repetitive flags are
optional during local development.

### Discovery order

1. Project-level `.m5nvrc` in your working directory.
2. User config: `~/.m5nv/rc.json` (or `$M5NV_HOME/rc.json` when M5NV_HOME is set).

Run with `--no-config` to skip discovery entirely. This is useful when testing
error scenarios or validating the base CLI behavior.

### Schema

Configuration files are UTF-8 JSON objects supporting the fields below:

```json
{
  "repo": "owner/templates",
  "branch": "main",
  "author": {
    "name": "Example Dev",
    "email": "dev@example.com",
    "url": "https://example.com"
  },
  "placeholders": {
    "PROJECT_NAME": "demo-app",
    "API_TOKEN": "example-token"
  }
}
```

- `repo` and `branch` seed CLI defaults when CLI flags are omitted.
- `author` metadata becomes available to setup scripts via the environment
  object (values are masked in logs).
- `placeholders` behave like `--placeholder` but with lower precedence than
  environment variables and CLI overrides.

Validation errors reference the offending path and instruct you to re-run with
`--no-config` if you need to bypass a broken file temporarily.

## Testing Strategy

The project follows a **testing pyramid** architecture that provides maximum confidence with optimal efficiency. Each level validates specific aspects of the system without redundancy.

### Testing Pyramid Structure

| Level | Command | Purpose | Confidence Level | Speed |
|-------|---------|---------|------------------|-------|
| **Unit** | `npm run test:unit` | Core components & infrastructure (L2/L3) | **Foundation** - Ensures basic functionality works | ‚ö° Fast |
| **Integration** | `npm run test:integration` | Command-level functionality (L3/L4) | **Feature** - Validates individual commands work | üöÄ Medium |
| **System** | `npm run test:system` | Full end-to-end workflows (L4) | **Production** - Validates complete system behavior | üêå Slow |

### Test Level Details

#### Unit Tests (`npm run test:unit`)
**Purpose**: Validate core components and infrastructure work correctly in isolation.

**Covers**:
- Interactive Utils: Environment detection and interactive mode logic
- Security Tests: Input validation and attack prevention
- Template Validator: Schema validation and manifest processing
- Base Command: Command framework and argument parsing
- Router: Command dispatch and routing logic
- Template Schema Build: TypeScript artifact generation

**When to run**: During active development, after any infrastructure changes.

#### Integration Tests (`npm run test:integration`)
**Purpose**: Validate that individual CLI commands work end-to-end with file system operations.

**Covers**:
- Create-Scaffold New: Project creation with templates
- Create-Scaffold List: Template listing and discovery
- Create-Scaffold Validate: Template validation commands
- Make-Template Init: Template skeleton generation
- Make-Template Hints: Authoring guidance display
- Make-Template Convert: Project-to-template conversion
- Make-Template Restore: Template-to-project restoration
- Make-Template Test: Template testing integration
- Make-Template Validate: Template validation and compliance

**When to run**: After command changes, during feature development.

#### System Tests (`npm run test:system`)
**Purpose**: Validate complete system behavior under realistic conditions with resource management.

**Covers**:
- Functional Tests: Comprehensive end-to-end CLI behavior
- Resource Leak Tests: Memory, file handle, and temporary directory cleanup

**When to run**: Before releases, for production readiness validation.

### Testing Methodology

**Test-First Development**: All functionality developed using strict TDD:

1. Write failing tests that define expected behavior
2. Implement minimal code to make tests pass
3. Refactor while maintaining green tests
4. Validate with appropriate test pyramid level

**Security Testing**: Every security feature thoroughly tested:

- Path traversal prevention with malicious inputs
- Command injection blocking with crafted payloads
- Input validation with edge cases and boundary conditions
- Error message sanitization to prevent information disclosure

**Performance Testing**: System tests include performance validation and resource leak detection.

## Testing the CLI Locally

### 1. Direct Node Execution (Development)

Test changes immediately without installation:

```bash
#Test CLI directly during development
node bin/create-scaffold/index.mjs --help
node bin/create-scaffold/index.mjs new my-test-app react-vite
node bin/create-scaffold/index.mjs new test-project myorg/templates --template custom

#Test specific scenarios
node bin/create-scaffold/index.mjs list myorg/templates
node bin/create-scaffold/index.mjs new test-app express --dry-run

#Test make-template commands
node bin/make-template/index.mjs --help
node bin/make-template/index.mjs init
```

### 2. npm link (Global Binary)

Creates global symlinks for the `create-scaffold` and `make-template` binaries. **Note:** `npm create @m5nv/scaffold` still attempts to download from npm and will fail until the package is published. Use the `create-scaffold` and `make-template` binaries instead.

> **Linux Note**: On some Linux systems, `npm link` may not properly set executable permissions on the symlinked binary. If you encounter "permission denied" errors, run: `chmod +x $(npm root -g)/.bin/create-scaffold $(npm root -g)/.bin/make-template`

```bash
#Link your local package globally
npm link

#Run the CLI via the linked binaries
create-scaffold new my-test-app react-vite
create-scaffold new my-api myorg/templates --template express
make-template init
make-template convert my-project

#Test new features
create-scaffold new test-project react --log-file ./build.log
create-scaffold new preview-app vue --dry-run

#Cleanup when done
npm unlink -g @m5nv/create-scaffold
```

### 3. Local Installation (Production Simulation)

Install your local version globally to simulate a published install. The entry points are the `create-scaffold` and `make-template` binaries.

```bash
#Install from current directory
npm install -g .

#Use normally
create-scaffold new my-app some-template
make-template init

#Uninstall when done
npm uninstall -g @m5nv/create-scaffold
```

## Running Tests

### Testing Pyramid Commands

```bash
#Complete test suite (all pyramid levels)
npm test

#Individual pyramid levels
npm run test:unit         # Foundation: Core components & infrastructure (L2/L3)
npm run test:integration  # Feature: Command-level functionality (L3/L4)
npm run test:system       # Production: Full end-to-end workflows (L4)

# Tool-specific test groups
npm run test:create-scaffold  # All create-scaffold related tests
npm run test:make-template    # All make-template related tests

# Code quality
npm run lint              # Zero warnings required
```

### Development Testing Workflow

**During Active Development** (Fast feedback loop):
```bash
npm run test:unit         # Quick validation of core changes
npm run test:integration  # Validate command functionality
```

**Before Commits** (Feature validation):
```bash
npm run test:integration  # Ensure commands work end-to-end
npm run lint              # Code quality check
```

**Before Releases** (Production readiness):
```bash
npm run test:system       # Full system validation
npm test                  # Complete suite (all 37 test suites)
```

**Debugging Specific Issues**:
```bash
# Test pyramid level by level to isolate problems
npm run test:unit         # Check infrastructure (L2/L3)
npm run test:integration  # Check command functionality (L3/L4)
npm run test:system       # Check full system behavior (L4)

#Run individual test suites for deep debugging
npm run test:suite "Security Tests"        # Debug security issues
npm run test:suite "Create-Scaffold New Tests"  # Debug specific commands
npm run test:suite "Spec Compliance Tests"      # Debug spec violations
```

### Test Execution Strategy

**Confidence Building Approach**:
1. **Unit tests** catch implementation bugs early
2. **Integration tests** validate feature functionality
3. **System tests** confirm production readiness

**Performance-Optimized Workflow**:
- Use `test:unit` + `test:integration` during development (fast feedback)
- Use `test:system` for final validation (comprehensive)
- Use `npm test` for complete validation before releases (all 37 test suites)

### Test specific functionality
```bash
node tests/create-scaffold/cli.test.mjs
node tests/shared/security.test.mjs
...
node tests/shared/cache-manager.test.mjs
node tests/shared/logger.test.mjs
node tests/shared/template-discovery.test.mjs
...
```

### Test Output Interpretation

**Successful Test Run**:

```console
üß™ Functional Tests
   36 end-to-end CLI behavior tests
‚úÖ Functional Tests - 1247ms

üß™ Spec Compliance Tests
   32 specification compliance tests
‚úÖ Spec Compliance Tests - 892ms

üìä TEST SUITE SUMMARY
‚úÖ Functional Tests              1247ms
‚úÖ Spec Compliance Tests         892ms
‚úÖ Resource Leak Tests           156ms
‚úÖ Smoke Tests                   2341ms

üìà Results: 4 passed, 0 failed
‚è±Ô∏è  Total time: 4636ms
üéâ CLI tool is ready for production!
```

**Failed Test Analysis**:

- Review specific test failures in the output
- Check error messages for validation failures
- Verify security tests haven't been compromised
- Ensure all spec compliance tests pass before release

## Build and Release Process

### Pre-Release Validation

Before any release, the following validation must pass:

```bash
# 1. Code quality validation
npm run lint                    # Must show zero warnings

# 2. Testing pyramid validation (bottom-up confidence building)
npm run test:unit               # Foundation: Core components work (L2/L3)
npm run test:integration        # Feature: Commands work end-to-end (L3/L4)
npm run test:system             # Production: Full system validation (L4)

# 3. Complete suite validation
npm test                        # All tests pass together

# 4. Manual CLI validation (local execution)
node bin/create-scaffold/index.mjs --help
npx . new test-release react-vite
npm link
create-scaffold new test-release react-vite
make-template --help
npm unlink -g @m5nv/create-scaffold
```

### Version Management

```bash
#Update version (automatically updates package.json and creates git tag)
npm version patch              # Bug fixes: 1.0.0 ‚Üí 1.0.1
npm version minor              # New features: 1.0.0 ‚Üí 1.1.0
npm version major              # Breaking changes: 1.0.0 ‚Üí 2.0.0

#Push release to repository
git push origin main --tags

#Publish to npm (if applicable)
npm publish
```

### Release Checklist

- [ ] All tests pass (`npm test` - 37 test suites)
- [ ] Zero lint warnings (`npm run lint`)
- [ ] System tests pass (`npm run test:system`)
- [ ] Manual CLI testing completed
- [ ] Documentation updated for new features
- [ ] CHANGELOG.md updated with changes
- [ ] Version bumped appropriately
- [ ] Git tags created and pushed

## Code Quality Standards

### Linting and Formatting

```bash
#Check for lint issues (must show zero warnings)
npm run lint

#The project maintains strict code quality:
# - ESLint with comprehensive rules
# - ES Modules only (no CommonJS)
# - Modern JavaScript patterns
# - Consistent code formatting
```

### Security Standards

The project follows strict security guidelines:

- **Zero External Dependencies**: Only Node.js built-ins to minimize attack surface
- **Comprehensive Input Validation**: All user inputs sanitized and validated
- **Security-First Error Handling**: No information disclosure in error messages
- **Path Traversal Prevention**: All file operations bounded to safe directories
- **Command Injection Prevention**: Safe argument passing to child processes
- **Setup Script Isolation**: User scripts run in project context, not CLI context

### Code Review Requirements

All code changes must meet these standards:

- **Security Review**: All input validation and error handling reviewed
- **Test Coverage**: New functionality must include comprehensive tests
- **Documentation**: Public APIs and complex logic must be documented
- **Performance**: No unnecessary dependencies or blocking operations
- **Compatibility**: Must work on supported Node.js versions across platforms

## Coding Standards

### JavaScript/Node.js Standards

**ES Modules Only**:

```javascript
// ‚úÖ Correct: Use ES module imports
import { readFile } from "fs/promises";
import path from "path";

// ‚ùå Incorrect: No CommonJS patterns
const fs = require("fs");
```

**Async/Await Patterns**:

```javascript
// ‚úÖ Correct: Use async/await for all async operations
async function processTemplate(templatePath) {
  try {
    const content = await readFile(templatePath, "utf8");
    return processContent(content);
  } catch (error) {
    throw new Error(`Failed to process template: ${error.message}`);
  }
}

// ‚ùå Incorrect: No callback patterns
fs.readFile(templatePath, (err, data) => {
  /* ... */
});
```

**Error Handling**:

```javascript
// ‚úÖ Correct: Comprehensive error handling with context
try {
  await gitClone(repoUrl, targetPath);
} catch (error) {
  throw new Error(`Git clone failed for ${repoUrl}: ${error.message}`);
}

// ‚ùå Incorrect: Generic error handling
try {
  await gitClone(repoUrl, targetPath);
} catch (error) {
  throw error; // No context added
}
```

**Input Validation**:

```javascript
// ‚úÖ Correct: Validate all inputs
function validateProjectName(name) {
  if (!name || typeof name !== "string") {
    throw new Error("Project name must be a non-empty string");
  }
  if (name.includes("..") || name.includes("/")) {
    throw new Error("Project name contains invalid characters");
  }
  return name.trim();
}

// ‚ùå Incorrect: No validation
function createProject(name) {
  // Direct usage without validation
  return fs.mkdir(name);
}
```

### File Organization Standards

**Module Structure**:

```javascript
// File header with purpose
/**
 * Cache Manager for Template Repositories
 * Handles local caching with TTL support and corruption recovery
 */

// Imports (Node.js built-ins only)
import fs from "fs/promises";
import path from "path";
import crypto from "crypto";

// Class or function definitions
export class CacheManager {
  // Implementation
}

// Default export (if applicable)
export default CacheManager;
```

**Function Documentation**:

```javascript
/**
 * Retrieves a cached repository or clones it if not cached/expired
 * @param {string} repoUrl - Git repository URL
 * @param {string} branchName - Git branch name
 * @param {Object} options - Cache options
 * @param {boolean} options.bypassCache - Skip cache and clone directly
 * @param {number} options.ttlHours - Cache TTL in hours
 * @returns {Promise<string>} Path to cached repository
 * @throws {Error} If repository cannot be accessed or cached
 */
async getCachedRepo(repoUrl, branchName, options = {}) {
  // Implementation
}
```

## Development Workflow

### Spec-Driven Development Process

This project follows a rigorous spec-driven development methodology. See [Kiro Methodology](../../AGENTS.md) for complete details.

**Quick Overview**:

1. **Requirements Phase**: Write EARS-compliant requirements with user stories
2. **Design Phase**: Create comprehensive technical design
3. **Implementation Phase**: Break design into actionable coding tasks
4. **Execution Phase**: Implement tasks with test-first development

### Making Changes

#### 1. Test-First Development (Mandatory)

```bash
#ALWAYS write tests first
# 1. Search existing codebase for similar functionality
grep -r "similar_function" bin/ tests/

# 2. Write failing tests that define expected behavior
# Edit appropriate test file in tests/

# 3. Run tests to confirm they fail (RED)
npm run test:integration

# 4. Implement minimal code to make tests pass (GREEN)
# Edit implementation files in bin/

# 5. Run tests to confirm they pass
npm run test:integration

# 6. Refactor if needed while keeping tests green
```

#### 2. Implementation Workflow

```bash
# Full development workflow
npm run lint          # Check code quality first
npm run test:unit     # Quick validation of core changes
node bin/create-scaffold/index.mjs --help  # Test CLI directly

# After changes
npm test             # Run complete test suite
npm run lint         # Verify code quality
```

#### 3. Feature Development Process

For new features, follow the spec-driven process:

```bash
# 1. Create feature specification
mkdir -p .kiro/specs/feature-name
# Write requirements.md, design.md, tasks.md

# 2. Implement following tasks.md
# Mark tasks complete as you go

# 3. Validate implementation
npm run test:system        # Verify system behavior
```

### Debugging and Troubleshooting

#### Development Debugging

```bash
# Test specific scenarios during development
node bin/create-scaffold/index.mjs new test-debug nonexistent  # Error handling
node bin/create-scaffold/index.mjs new ../test hack            # Security validation
node bin/create-scaffold/index.mjs new valid-project react --dry-run  # Preview mode

# Test with logging enabled
node bin/create-scaffold/index.mjs new my-app react --log-file debug.log
cat debug.log  # Review detailed operation logs
```

#### Test Debugging

```bash
# Run specific test suites for focused debugging (much better than grep!)
npm run test:unit          # Debug infrastructure issues
npm run test:integration   # Debug command functionality
npm run test:system        # Debug end-to-end issues
npm run test:suite "Security Tests"  # Debug specific security issues

# Run individual test files for deep debugging
node tests/create-scaffold/cli.test.mjs
node tests/shared/security.test.mjs
node tests/create-scaffold/cache-manager.test.mjs
```

#### Common Development Issues

**Tests failing after changes**:

- Run `npm run test:quick` for faster feedback
- Check specific test output for validation failures
- Ensure security tests still pass (critical for releases)

**CLI not working with npm link**:

- Run via `create-scaffold` (not `npm create @m5nv/scaffold`, which still hits npm)
- Unlink and relink: `npm unlink -g @m5nv/create-scaffold && npm link`
- Check global npm modules: `npm list -g --depth=0`
- **Linux-specific**: `npm link` may not preserve executable permissions on some Linux systems. If you get "permission denied" errors, manually set executable permissions:
  ```bash
  chmod +x $(npm root -g)/.bin/create-scaffold
  ```
### Verify bin file permissions: `chmod +x bin/create-scaffold/index.mjs bin/make-template/index.mjs`

**Permission issues during testing**:

- Ensure test directories are writable
- Check temporary directory cleanup in tests
- Verify git configuration for test repositories

### Performance Considerations

#### Optimization Guidelines

- **Minimize I/O Operations**: Use caching and batch operations where possible
- **Async Operations**: Never block the event loop with sync operations
- **Memory Management**: Clean up temporary resources and large objects
- **Git Operations**: Use shallow clones (`--depth 1`) for template repositories

#### Performance Testing

```bash
# Test performance with large repositories
time node bin/create-scaffold/index.mjs new perf-test large-template

# Test cache performance
node bin/create-scaffold/index.mjs new test1 react  # First run (clone)
time node bin/create-scaffold/index.mjs new test2 react  # Second run (cached)

# Test with multiple templates
npm run test:integration  # Includes performance validation
```

## Contributing to the Project

### Quick Contribution Guide

See [CONTRIBUTING.md](../../CONTRIBUTING.md) for complete contribution guidelines.

**Essential Steps**:

1. Fork and clone the repository
2. Create a feature branch: `git checkout -b feature/description`
3. Follow test-first development: write tests, then implementation
4. Ensure all tests pass: `npm test`
5. Verify code quality: `npm run lint`
6. Test locally: `node bin/create-scaffold/index.mjs`, `npx .`, or `create-scaffold` via `npm link`
7. Submit pull request with clear description

### Contribution Standards

**Code Requirements**:

- Zero external dependencies (Node.js built-ins only)
- ES Modules only (no CommonJS)
- Comprehensive test coverage for new functionality
- Security-first approach with input validation
- Documentation updates for public APIs

**Testing Requirements**:

- Complete test suite must pass
- New functionality must include tests
- Security tests must not be compromised
- Manual CLI testing required with both `create-scaffold` and `make-template` commands with both `create-scaffold` and `make-template` commands

### Development Environment Setup

```bash
# Complete setup for contributors
git clone https://github.com/million-views/create.git
cd create
npm install

# Verify setup
npm test                       # Should pass all tests
npm run lint                   # Should show zero warnings
node bin/create-scaffold/index.mjs --help      # Should display help

# Test contribution workflow
npm link
create-scaffold new test-contrib react-vite
make-template init
npm unlink -g @m5nv/create-scaffold
```

## Troubleshooting Development Issues

### Common Development Problems

**Tests failing after changes**:

```bash
# Quick diagnosis
npm run test:unit               # Check infrastructure
npm run test:integration        # Check command functionality
npm run test:system             # Focus on CLI behavior
node tests/shared/security.test.mjs  # Verify security isn't compromised

# Check specific failures
npm test 2>&1 | grep -A 5 "FAILED"
```

```bash
# Fix linking issues (remember to invoke the CLI via `create-scaffold`)
npm unlink -g @m5nv/create-scaffold
npm link
npm list -g --depth=0          # Verify global installation

# Alternative: direct installation
npm install -g .
create-scaffold new my-app react
```

**Permission issues during development**:

```bash
# Fix bin file permissions
chmod +x bin/create-scaffold/index.mjs
chmod +x bin/make-template/index.mjs

# Check test directory permissions
ls -la tests/
ls -la bin/

# Verify git configuration
git config --list | grep user
```

**Performance issues during testing**:

```bash
# Clear test artifacts
rm -rf /tmp/create-scaffold-* 2>/dev/null || true
rm -rf ~/.m5nv/cache/*

# Check disk space
df -h

# Monitor resource usage
npm run test:leaks              # Check for resource leaks
```

**Git authentication in tests**:

- Tests use mock repositories and don't require real git authentication
- For manual testing with private repositories, ensure git credentials are configured
- Use `git config --global credential.helper` to check credential configuration

### Advanced Debugging

**Memory and Performance Analysis**:

```bash
# Profile memory usage
node --inspect bin/create-scaffold/index.mjs new my-app react
# Open chrome://inspect in Chrome

# Check for memory leaks
npm run test:leaks

# Performance profiling
time npm run test:system
```

**Security Testing**:

```bash
# Test security validations
node bin/create-scaffold/index.mjs new "../evil" hack     # Should be blocked
node bin/create-scaffold/index.mjs new "test; rm -rf /tmp" safe  # Should be blocked
node bin/create-scaffold/index.mjs new test "hack; evil"  # Should be blocked
```

**Cache Debugging**:

```bash
# Inspect cache state
ls -la ~/.m5nv/cache/
cat ~/.m5nv/cache/*/metadata.json

# Clear cache for testing
rm -rf ~/.m5nv/cache/*

# Test cache functionality
node bin/create-scaffold/index.mjs new test1 react        # Should clone
node bin/create-scaffold/index.mjs new test2 react        # Should use cache
node bin/create-scaffold/index.mjs new test3 react --no-cache  # Should clone
```

## Additional Resources

### Documentation

- [Kiro Methodology](../../AGENTS.md) - Complete guide to the project's development methodology
- [CONTRIBUTING.md](../../CONTRIBUTING.md) - Contribution guidelines and standards
- [User Documentation](../../README.md) - User-facing documentation and guides

### Project Specifications

- [Phase 1 Core UX Spec](../../.kiro/specs/tools/create-scaffold/phase-1-core-ux/) - Caching, logging, discovery, dry-run features
- [Documentation Overhaul Spec](../../.kiro/specs/tools/create-scaffold/documentation-overhaul-diataxis/) - Documentation restructuring project
- [CLI Compliance Update Spec](../../.kiro/specs/tools/create-scaffold/cli-compliance-update/) - CLI standards compliance

### External Resources

- [Node.js Documentation](https://nodejs.org/docs/) - Official Node.js API documentation
- [ESLint Configuration](https://eslint.org/docs/) - Code quality and linting standards
- [EARS Requirements](https://alistairmavin.com/ears/) - Requirements writing methodology
- [Di√°taxis Framework](https://diataxis.fr/) - Documentation structure methodology

This development guide provides comprehensive information for contributing to @m5nv/create-scaffold. For questions not covered here, please open an issue or start a discussion in the project repository.

## What's Next

Now that you have the development environment set up, you might want to:

- üí° **Understand the methodology**: [Kiro Methodology](../../AGENTS.md) - Learn our development process
- ü§ù **Make your first contribution**: [Contributing Guidelines](../../CONTRIBUTING.md) - Step-by-step contribution process
- üö® **Debug issues**: [Troubleshooting Guide](../guides/troubleshooting.md) - Resolve development and runtime problems
- üìñ **Understand the CLI**: [CLI Reference](../reference/cli-reference.md) - Complete command documentation
